<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# dockercompose

```go
import "github.com/blueprint-uservices/blueprint/plugins/dockercompose"
```

Package dockercompose is a plugin for instantiating multiple container instances in a single docker\-compose deployment.

### Wiring Spec Usage

To use the dockercompose plugin in your wiring spec, you can declare a deployment, giving it a name and specifying which container instances to include

```
dockercompose.NewDeployment(spec, "my_deployment", "my_container_1", "my_container_2")
```

You can add containers to existing deployments:

```
dockercompose.AddContainerToDeployment(spec, "my_deployment", "my_container_3")
```

### Artifacts Generated

During compilation, the plugin generates a docker\-compose file that instantiates images for the specified containers. The plugin also sets environment variables and ports for the instances.

dockercompose is the default builder for container images: if your wiring spec defines containers but doesn't further put them into a namespace, then by default Blueprint will generate a dockercompose file.

### Running Artifacts

If the dockercompose deployment is not further combined by other plugins, then the entry point to running your application will be using docker\-compose. You can build or run the deployment with:

```
docker-compose build
docker-compose up
```

Although the plugin automatically assigns and sets hostnames and ports for containers, you will still need to set some environment variables for ports to expose on the local host. If you try to build or run the docker\-compose file when these are absent, Docker will complain about their absence. You can write these to a .env file or set them in your local environment.

For a concrete guide on running a generated docker\-compose file, see the [SockShop Getting Started](<https://github.com/Blueprint-uServices/blueprint/tree/main/examples/sockshop>) documentation.

### Internals

Internally, the plugin makes use of interfaces defined in the [docker](<https://github.com/Blueprint-uServices/blueprint/tree/main/plugins/docker>) plugin. It can combine any Container IRNodes including ones that use off\-the\-shelf container images, and ones that generate their own container image \(Dockerfile\) onto the local filesystem. Internally the plugin assigns hostnames to container instances and sets environment variables so that services call to the correct hostnames and ports.

## Index

- [func AddContainerToDeployment\(spec wiring.WiringSpec, deploymentName, containerName string\)](<#AddContainerToDeployment>)
- [func NewDeployment\(spec wiring.WiringSpec, deploymentName string, containers ...string\) string](<#NewDeployment>)
- [func RegisterAsDefaultBuilder\(\)](<#RegisterAsDefaultBuilder>)
- [type Deployment](<#Deployment>)
  - [func \(deployment \*Deployment\) Accepts\(nodeType any\) bool](<#Deployment.Accepts>)
  - [func \(deployment \*Deployment\) AddEdge\(name string, edge ir.IRNode\) error](<#Deployment.AddEdge>)
  - [func \(deployment \*Deployment\) AddNode\(name string, node ir.IRNode\) error](<#Deployment.AddNode>)
  - [func \(node \*Deployment\) GenerateArtifacts\(dir string\) error](<#Deployment.GenerateArtifacts>)
  - [func \(node \*Deployment\) Name\(\) string](<#Deployment.Name>)
  - [func \(node \*Deployment\) String\(\) string](<#Deployment.String>)
- [type DeploymentNamespace](<#DeploymentNamespace>)


<a name="AddContainerToDeployment"></a>
## func [AddContainerToDeployment](<https://github.com/blueprint-uservices/blueprint/blob/main/plugins/dockercompose/wiring.go#L59>)

```go
func AddContainerToDeployment(spec wiring.WiringSpec, deploymentName, containerName string)
```

Adds a child node to an existing container deployment

<a name="NewDeployment"></a>
## func [NewDeployment](<https://github.com/blueprint-uservices/blueprint/blob/main/plugins/dockercompose/wiring.go#L65>)

```go
func NewDeployment(spec wiring.WiringSpec, deploymentName string, containers ...string) string
```

Adds a deployment that explicitly instantiates all of the containers provided. The deployment will also implicitly instantiate any of the dependencies of the containers

<a name="RegisterAsDefaultBuilder"></a>
## func [RegisterAsDefaultBuilder](<https://github.com/blueprint-uservices/blueprint/blob/main/plugins/dockercompose/defaults.go#L10>)

```go
func RegisterAsDefaultBuilder()
```

to trigger module initialization and register builders

<a name="Deployment"></a>
## type [Deployment](<https://github.com/blueprint-uservices/blueprint/blob/main/plugins/dockercompose/ir.go#L8-L15>)

A deployment is a collection of containers

```go
type Deployment struct {
    DeploymentName string
    Nodes          []ir.IRNode
    Edges          []ir.IRNode
    // contains filtered or unexported fields
}
```

<a name="Deployment.Accepts"></a>
### func \(\*Deployment\) [Accepts](<https://github.com/blueprint-uservices/blueprint/blob/main/plugins/dockercompose/wiring.go#L86>)

```go
func (deployment *Deployment) Accepts(nodeType any) bool
```

Implements \[wiring.NamespaceHandler\]

<a name="Deployment.AddEdge"></a>
### func \(\*Deployment\) [AddEdge](<https://github.com/blueprint-uservices/blueprint/blob/main/plugins/dockercompose/wiring.go#L92>)

```go
func (deployment *Deployment) AddEdge(name string, edge ir.IRNode) error
```

Implements \[wiring.NamespaceHandler\]

<a name="Deployment.AddNode"></a>
### func \(\*Deployment\) [AddNode](<https://github.com/blueprint-uservices/blueprint/blob/main/plugins/dockercompose/wiring.go#L98>)

```go
func (deployment *Deployment) AddNode(name string, node ir.IRNode) error
```

Implements \[wiring.NamespaceHandler\]

<a name="Deployment.GenerateArtifacts"></a>
### func \(\*Deployment\) [GenerateArtifacts](<https://github.com/blueprint-uservices/blueprint/blob/main/plugins/dockercompose/deploy.go#L50>)

```go
func (node *Deployment) GenerateArtifacts(dir string) error
```

Implements ir.ArtifactGenerator

<a name="Deployment.Name"></a>
### func \(\*Deployment\) [Name](<https://github.com/blueprint-uservices/blueprint/blob/main/plugins/dockercompose/ir.go#L18>)

```go
func (node *Deployment) Name() string
```

Implements IRNode

<a name="Deployment.String"></a>
### func \(\*Deployment\) [String](<https://github.com/blueprint-uservices/blueprint/blob/main/plugins/dockercompose/ir.go#L23>)

```go
func (node *Deployment) String() string
```

Implements IRNode

<a name="DeploymentNamespace"></a>
## type [DeploymentNamespace](<https://github.com/blueprint-uservices/blueprint/blob/main/plugins/dockercompose/wiring.go#L81-L83>)

A \[wiring.NamespaceHandler\] used to build container deployments

```go
type DeploymentNamespace struct {
    *Deployment
}
```

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
