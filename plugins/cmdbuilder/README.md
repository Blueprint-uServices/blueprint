<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# cmdbuilder

```go
import "github.com/blueprint-uservices/blueprint/plugins/cmdbuilder"
```

Package cmdbuilder is a helper package for building wiring spec command line programs. It doesn't provide any wiring spec commands or IR.

The [CmdBuilder](<#CmdBuilder>) struct enables an application to register multiple wiring spec options in a single main.go. It adds command line arguments for selecting which wiring spec to compile, and takes care of argument parsing and spec building.

Specify the name of a wiring spec with the \-w argument, and the output directory with \-o.

### Usage

Define one or more wiring specs. Each wiring spec should be implemented inside a function with the following signature:

```
func (spec wiring.WiringSpec) ([]string, error)
```

The function should behave like a typical wiring spec: instantiating workflow services, deploying them inside processes or containers, etc.

Next, define a [SpecOption](<#SpecOption>):

```
func buildMySpec(spec wiring.WiringSpec) ([]string, error) {
	... // does wiring spec stuff
}

var MySpec = cmdbuilder.SpecOption{
	Name:        "myspec",
	Description: "My example wiring spec",
	Build:       buildMySpec,
}
```

Lastly, in the main file, call [MakeAndExecute](<#MakeAndExecute>):

```
cmdbuilder.MakeAndExecute(
	"MyApplication",
	MySpec
)
```

[MakeAndExecute](<#MakeAndExecute>) accepts any number of specs. cmdbuilder takes care of parsing command line args

### Runtime Usage

Run your program with

```
go run main.go -h
```

The cmdbuilder plugin takes care of argument parsing, and will list the wiring specs that can be compiled.

To compile a spec, run

```
go run main.go -o build -w myspec
```

## Index

- [func MakeAndExecute\(name string, specs ...SpecOption\)](<#MakeAndExecute>)
- [type CmdBuilder](<#CmdBuilder>)
  - [func NewCmdBuilder\(applicationName string\) \*CmdBuilder](<#NewCmdBuilder>)
  - [func \(b \*CmdBuilder\) Add\(specs ...SpecOption\)](<#CmdBuilder.Add>)
  - [func \(b \*CmdBuilder\) Build\(\) error](<#CmdBuilder.Build>)
  - [func \(builder \*CmdBuilder\) List\(\) string](<#CmdBuilder.List>)
  - [func \(b \*CmdBuilder\) ParseArgs\(\)](<#CmdBuilder.ParseArgs>)
  - [func \(b \*CmdBuilder\) ValidateArgs\(\) error](<#CmdBuilder.ValidateArgs>)
- [type SpecOption](<#SpecOption>)


<a name="MakeAndExecute"></a>
## func [MakeAndExecute](<https://github.com/blueprint-uservices/blueprint/blob/main/plugins/cmdbuilder/cmdbuilder.go#L102>)

```go
func MakeAndExecute(name string, specs ...SpecOption)
```

Parses command line flags, and if a valid spec is specified with the \-w flag, that exists within specs, executes that spec.

<a name="CmdBuilder"></a>
## type [CmdBuilder](<https://github.com/blueprint-uservices/blueprint/blob/main/plugins/cmdbuilder/cmdbuilder.go#L86-L98>)

A helper struct when a Blueprint application supports multiple different wiring specs. Makes it easy to choose which spec to compile. See the Blueprint example applications for usage

```go
type CmdBuilder struct {
    Name      string
    OutputDir string
    Quiet     bool
    SpecName  string
    Env       bool
    Port      uint16
    Spec      SpecOption
    Wiring    wiring.WiringSpec
    IR        *ir.ApplicationNode

    Registry map[string]SpecOption
}
```

<a name="NewCmdBuilder"></a>
### func [NewCmdBuilder](<https://github.com/blueprint-uservices/blueprint/blob/main/plugins/cmdbuilder/cmdbuilder.go#L118>)

```go
func NewCmdBuilder(applicationName string) *CmdBuilder
```



<a name="CmdBuilder.Add"></a>
### func \(\*CmdBuilder\) [Add](<https://github.com/blueprint-uservices/blueprint/blob/main/plugins/cmdbuilder/cmdbuilder.go#L125>)

```go
func (b *CmdBuilder) Add(specs ...SpecOption)
```



<a name="CmdBuilder.Build"></a>
### func \(\*CmdBuilder\) [Build](<https://github.com/blueprint-uservices/blueprint/blob/main/plugins/cmdbuilder/cmdbuilder.go#L179>)

```go
func (b *CmdBuilder) Build() error
```



<a name="CmdBuilder.List"></a>
### func \(\*CmdBuilder\) [List](<https://github.com/blueprint-uservices/blueprint/blob/main/plugins/cmdbuilder/cmdbuilder.go#L171>)

```go
func (builder *CmdBuilder) List() string
```

Returns a list of configured wiring specs

<a name="CmdBuilder.ParseArgs"></a>
### func \(\*CmdBuilder\) [ParseArgs](<https://github.com/blueprint-uservices/blueprint/blob/main/plugins/cmdbuilder/cmdbuilder.go#L131>)

```go
func (b *CmdBuilder) ParseArgs()
```



<a name="CmdBuilder.ValidateArgs"></a>
### func \(\*CmdBuilder\) [ValidateArgs](<https://github.com/blueprint-uservices/blueprint/blob/main/plugins/cmdbuilder/cmdbuilder.go#L147>)

```go
func (b *CmdBuilder) ValidateArgs() error
```



<a name="SpecOption"></a>
## type [SpecOption](<https://github.com/blueprint-uservices/blueprint/blob/main/plugins/cmdbuilder/cmdbuilder.go#L77-L81>)

A wiring spec option used by [CmdBuilder](<#CmdBuilder>). When running the program, this wiring spec can be selected by specifying its \[Name\] with the \-w flag, e.g.

```
-w {{.Name}}
```

```go
type SpecOption struct {
    Name        string
    Description string
    Build       func(wiring.WiringSpec) ([]string, error)
}
```

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
