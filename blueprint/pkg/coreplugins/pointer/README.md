<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# pointer

```go
import "gitlab.mpi-sws.org/cld/blueprint/blueprint/pkg/coreplugins/pointer"
```

Package pointer provides the core functionality for wrapping clients and servers with modifier nodes such as tracing, RPC, and many more.

The functionality in this package is primarily intended for use by other Blueprint plugins.

When a plugin declares an IR node, if that node represents something like a service whose interfaces can be further wrapped by other plugins, then in addition to the original IR node definition, the plugin should also declare a pointer to that IR node.

Once a pointer is declared, other plugins can wrap the client or server side of the pointer. Many plugins \*only\* apply to nodes that have pointers declared, and will get compilation errors for non\-pointer nodes.

Other Blueprint plugins apply client and server modifications by calling \[AddSrcModifier\] or \[AddDstModifier\].

Internally the pointer keeps track of the modifier nodes that have been applied to the pointer.

Typically there is an address node internally that separates the client side and server side of the pointer. This is not implemented here directly \-\- a plugin should explicitly add an address node if it has separate client and server processes. For example, a service will only add an address node when it is deployed over RPC.

The server side of a pointer is usually instantiated lazily, because typically the server does not want to live in the same namespace as the client.

The method \[InstantiateDst\] is used by other Blueprint plugins that wish to explicitly instantiate the server side of a pointer in a particular namespace.

## Index

- [func RequireUniqueness\(spec wiring.WiringSpec, alias string, visibility any\)](<#RequireUniqueness>)
- [type ModifierOpts](<#ModifierOpts>)
- [type PointerDef](<#PointerDef>)
  - [func CreatePointer\[SrcNodeType any\]\(spec wiring.WiringSpec, name string, dst string, options ...PointerOpts\) \*PointerDef](<#CreatePointer>)
  - [func GetPointer\(spec wiring.WiringSpec, name string\) \*PointerDef](<#GetPointer>)
  - [func \(ptr \*PointerDef\) AddAddrModifier\(spec wiring.WiringSpec, addrName string\) string](<#PointerDef.AddAddrModifier>)
  - [func \(ptr \*PointerDef\) AddDstModifier\(spec wiring.WiringSpec, modifierName string, options ...ModifierOpts\) string](<#PointerDef.AddDstModifier>)
  - [func \(ptr \*PointerDef\) AddSrcModifier\(spec wiring.WiringSpec, modifierName string\) string](<#PointerDef.AddSrcModifier>)
  - [func \(ptr \*PointerDef\) InstantiateDst\(namespace wiring.Namespace\) error](<#PointerDef.InstantiateDst>)
  - [func \(ptr PointerDef\) String\(\) string](<#PointerDef.String>)
- [type PointerOpts](<#PointerOpts>)


<a name="RequireUniqueness"></a>
## func RequireUniqueness

```go
func RequireUniqueness(spec wiring.WiringSpec, alias string, visibility any)
```

A uniqueness check can be applied to any aliased node.

It requires that the specified node must be unique up to a certain granularity.

This is independent of whether it can be addressed by any node within that granularity.

The name argument should be an alias that this call will redefine.

<a name="ModifierOpts"></a>
## type ModifierOpts

Additional options that can be specified when adding a modifier to a pointer. If not specified, defaults are used.

```go
type ModifierOpts struct {
    // Defaults to true.  When true, the pointer's interface node is updated
    IsInterfaceNode bool
}
```

<a name="PointerDef"></a>
## type PointerDef

A PointerDef provides methods for plugins to add client or server side modifiers to a pointer.

Stored as metadata within a wiring spec.

```go
type PointerDef struct {
    // contains filtered or unexported fields
}
```

<a name="CreatePointer"></a>
### func CreatePointer

```go
func CreatePointer[SrcNodeType any](spec wiring.WiringSpec, name string, dst string, options ...PointerOpts) *PointerDef
```

Creates a pointer called name that points to the specified node dst. Type parameter \[SrcNodeType\] is the nodeType of the client side of the pointer.

Any plugin that defines client and server nodes should typically declare a pointer to the server node. Declaring a pointer will enable other plugins to apply client or server modifiers to the pointer. Additionally, pointers will automatically instantiate the server side of the pointer when using addresses

Additional pointer options can be specified by providing optional PointerOpts.

<a name="GetPointer"></a>
### func GetPointer

```go
func GetPointer(spec wiring.WiringSpec, name string) *PointerDef
```

Gets the PointerDef metadata for a pointer name that was defined using [CreatePointer](<#CreatePointer>)

<a name="PointerDef.AddAddrModifier"></a>
### func \(\*PointerDef\) AddAddrModifier

```go
func (ptr *PointerDef) AddAddrModifier(spec wiring.WiringSpec, addrName string) string
```

AddAddrModifier is a special case of AddDstModifier where the modifier is an address node.

It immediately instantiates the address, and returns it. It defers instantiation of the server side of the address.

The return value of AddAddrModifier is the name of the \_previous\_ server side modifier. This can be used within the BuildFunc of the destination \(PointsTo\) of addrName

<a name="PointerDef.AddDstModifier"></a>
### func \(\*PointerDef\) AddDstModifier

```go
func (ptr *PointerDef) AddDstModifier(spec wiring.WiringSpec, modifierName string, options ...ModifierOpts) string
```

Appends a modifier node called modifierName to the server side modifiers of a pointer.

Plugins use this method if they want to wrap the server side of a service, for example to add functionality like tracing, or to deploy a service with RPC.

A pointer can have multiple modifiers applied to it. They will be applied in the order that AddDstModifier was caleld.

The return value of AddDstModifier is the name of the \_previous\_ server side modifier. This can be used within the BuildFunc of modifierName.

<a name="PointerDef.AddSrcModifier"></a>
### func \(\*PointerDef\) AddSrcModifier

```go
func (ptr *PointerDef) AddSrcModifier(spec wiring.WiringSpec, modifierName string) string
```

Appends a modifier node called modifierName to the client side modifiers of a pointer.

Plugins use this method if they want to wrap the client side of a service, for example to add functionality like tracing, or to make calls over RPC.

A pointer can have multiple modifiers applied to it. They will be applied in the order that AddSrcModifier was called.

The return value of AddSrcModifier is the name of the \_next\_ client side modifier. This can be used within the BuildFunc of modifierName.

<a name="PointerDef.InstantiateDst"></a>
### func \(\*PointerDef\) InstantiateDst

```go
func (ptr *PointerDef) InstantiateDst(namespace wiring.Namespace) error
```

If any pointer modifiers are addresses, this will instantiate the server side of the addresses.

This is primarily used by namespace plugins.

<a name="PointerDef.String"></a>
### func \(PointerDef\) String

```go
func (ptr PointerDef) String() string
```



<a name="PointerOpts"></a>
## type PointerOpts

Additional options that can be specified when creating a pointer. If not specified, defaults are used.

```go
type PointerOpts struct {
    // If specified, applies [RequireUniqueness] to the pointer destination
    // before creating the pointer.  Set to nil to disable.  Defaults to
    // &ir.ApplicationNode{}
    RequireUniqueness any
}
```

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
